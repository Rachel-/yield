<%= form_tag({:action => 'edit', :tab => 'authentication'}) do %>

  <div class="form-group">
    <%= setting_check_box :login_required, :class => 'form-control' %>
  </div>

  <div class="form-group">
    <%= setting_select :autologin, [[l(:label_disabled), 0]] + [1, 7, 30, 365].collect{|days| [l('datetime.distance_in_words.x_days', :count => days), days.to_s]}, :class => 'form-control' %>
  </div>

  <div class="form-group">
    <%= setting_select :self_registration, [[l(:label_disabled), "0"], [l(:label_registration_activation_by_email), "1"], [l(:label_registration_manual_activation), "2"], [l(:label_registration_automatic_activation), "3"]], :class => 'form-control' %>
  </div>

  <div class="form-group">
    <%= setting_check_box :unsubscribe, :class => 'form-control' %>
  </div>

  <div class="form-group">
    <%= setting_text_field :password_min_length, :size => 6, :class => 'form-control' %>
  </div>

  <div class="form-group">
    <%= setting_check_box :lost_password, :label => :label_password_lost, :class => 'form-control' %>
  </div>

  <div class="form-group">
    <%= setting_check_box :openid, :disabled => !Object.const_defined?(:OpenID), :class => 'form-control' %>
  </div>

  <div class="form-group">
    <%= setting_check_box :rest_api_enabled, :class => 'form-control' %>
  </div>

  <div class="form-group">
    <%= setting_check_box :jsonp_enabled, :class => 'form-control' %>
  </div>

  <fieldset>
    <legend><%= l(:label_session_expiration) %></legend>

    <div class="form-group">
      <%= setting_select :session_lifetime, [[l(:label_disabled), 0]] + [1, 7, 30, 60, 365].collect{|days| [l('datetime.distance_in_words.x_days', :count => days), (days * 60 * 24).to_s]}, :class => 'form-control' %>
    </div>
    <div class="form-group">
      <%= setting_select :session_timeout, [[l(:label_disabled), 0]] + [1, 2, 4, 8, 12, 24, 48].collect{|hours| [l('datetime.distance_in_words.x_hours', :count => hours), (hours * 60).to_s]}, :class => 'form-control' %>
    </div>
    
    <span class="help-block"><%= l(:text_session_expiration_settings) %></span>
  </fieldset>

  <%= submit_tag l(:button_save), :class => 'btn btn-success' %>
<% end %>
